{% extends "base.html" %}

{% block title %}光伏新闻资讯平台 - 首页{% endblock %}

{% block content %}
<!-- 头部区域 -->
<div class="header-section">
    <div class="container text-center">
        <h1 class="display-4 fw-bold mb-4">光伏新闻资讯平台</h1>
        <p class="lead mb-5">一站式获取国内外最新光伏政策与行业动态</p>
    </div>
</div>

<!-- 功能选择区域 -->
<div class="container">
    <div class="row justify-content-center">
        <!-- 国内新闻卡片 -->
        <div class="col-md-5 mb-4">
            <div class="feature-card domestic">
                <div class="card-body text-center p-5">
                    <div class="feature-icon domestic mb-4">
                        <i class="fas fa-landmark"></i>
                    </div>
                    <h3 class="card-title h2 mb-3">国内政策新闻</h3>
                    <p class="card-text fs-5 mb-4">
                        实时获取国家能源局、中国政府网等权威机构发布的最新光伏政策、行业动态和发展规划
                    </p>
                    <div class="feature-stats mb-4">
                        <div class="row text-center">
                            <div class="col-6">
                                <div class="stat-number" id="domesticCount">--</div>
                                <div class="stat-label">新闻数量</div>
                            </div>
                            <div class="col-6">
                                <div class="stat-number" id="domesticUpdate">--</div>
                                <div class="stat-label">最后更新</div>
                            </div>
                        </div>
                    </div>
                    <a href="{{ url_for('news_search') }}" class="btn btn-primary btn-lg w-100">
                        <i class="fas fa-search me-2"></i>查看国内新闻
                    </a>
                </div>
            </div>
        </div>

        <!-- 国际新闻卡片 - 修改为融合翻译新闻 -->
        <div class="col-md-5 mb-4">
            <div class="feature-card international">
                <div class="card-body text-center p-5">
                    <div class="feature-icon international mb-4">
                        <i class="fas fa-globe-americas"></i>
                    </div>
                    <h3 class="card-title h2 mb-3">国际动态新闻</h3>
                    <p class="card-text fs-5 mb-4">
                        整合PV Magazine、IRENA、IEA等多来源国际太阳能新闻，支持中英文翻译和智能筛选
                    </p>
                    <div class="feature-stats mb-4">
                        <div class="row text-center">
                            <div class="col-6">
                                <div class="stat-number" id="internationalCount">--</div>
                                <div class="stat-label">新闻数量</div>
                            </div>
                            <div class="col-6">
                                <div class="stat-number" id="internationalUpdate">--</div>
                                <div class="stat-label">最后更新</div>
                            </div>
                        </div>
                    </div>
                    <a href="{{ url_for('translated_news') }}" class="btn btn-primary btn-lg w-100">
                        <i class="fas fa-external-link-alt me-2"></i>查看国际新闻
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- 平台介绍 -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="info-card">
                <div class="card-body p-4">
                    <h3 class="text-center mb-4"><i class="fas fa-info-circle me-2"></i>平台特色</h3>
                    <div class="row">
                        <div class="col-md-3 text-center mb-3">
                            <div class="info-icon">
                                <i class="fas fa-database"></i>
                            </div>
                            <h5>多数据源</h5>
                            <p class="text-muted">国内权威机构 + 国际多来源</p>
                        </div>
                        <div class="col-md-3 text-center mb-3">
                            <div class="info-icon">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <h5>实时更新</h5>
                            <p class="text-muted">一键刷新获取最新数据</p>
                        </div>
                        <div class="col-md-3 text-center mb-3">
                            <div class="info-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <h5>智能筛选</h5>
                            <p class="text-muted">按时间、关键词精准搜索</p>
                        </div>
                        <div class="col-md-3 text-center mb-3">
                            <div class="info-icon">
                                <i class="fas fa-language"></i>
                            </div>
                            <h5>多语言翻译</h5>
                            <p class="text-muted">国际新闻支持中英翻译</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 数据来源说明 -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="info-card">
                <div class="card-body p-4">
                    <h4 class="text-center mb-4"><i class="fas fa-list-alt me-2"></i>国际新闻数据来源</h4>
                    <div class="row justify-content-center">
                        <div class="col-md-3 text-center mb-3">
                            <div class="source-badge pv-badge">
                                <i class="fas fa-newspaper me-2"></i>PV Magazine
                            </div>
                            <p class="text-muted mt-2">全球光伏行业专业媒体</p>
                        </div>
                        <div class="col-md-3 text-center mb-3">
                            <div class="source-badge irena-badge">
                                <i class="fas fa-globe me-2"></i>IRENA
                            </div>
                            <p class="text-muted mt-2">国际可再生能源机构</p>
                        </div>
                        <div class="col-md-3 text-center mb-3">
                            <div class="source-badge iea-badge">
                                <i class="fas fa-chart-line me-2"></i>IEA
                            </div>
                            <p class="text-muted mt-2">国际能源署</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // 加载数据统计
    async function loadStats() {
        try {
            // 加载国内新闻统计
            const domesticResponse = await fetch('/get_stats');
            const domesticData = await domesticResponse.json();
            
            if (domesticData.success) {
                document.getElementById('domesticCount').textContent = domesticData.total_count;
                document.getElementById('domesticUpdate').textContent = domesticData.last_update ? 
                    domesticData.last_update.split(' ')[0] : '--';
            }
            
            // 加载国际新闻统计 - 改为使用翻译合并数据
            const internationalResponse = await fetch('/get_translated_stats');
            const internationalData = await internationalResponse.json();
            
            if (internationalData.success) {
                document.getElementById('internationalCount').textContent = internationalData.total_count;
                document.getElementById('internationalUpdate').textContent = internationalData.last_update ? 
                    internationalData.last_update.split(' ')[0] : '--';
            }
            
        } catch (error) {
            console.error('加载统计信息失败:', error);
        }
    }

    // 页面加载时获取统计信息
    document.addEventListener('DOMContentLoaded', function() {
        loadStats();
    });
</script>

<style>
.header-section {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 80px 0;
    margin-bottom: 60px;
}

.feature-card {
    border: none;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
    height: 100%;
}

.feature-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

.feature-card.domestic {
    border-top: 5px solid #4e73df;
}

.feature-card.international {
    border-top: 5px solid #ff6b35;
}

.feature-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    font-size: 2rem;
}

.feature-icon.domestic {
    background: linear-gradient(135deg, #4e73df, #6f8de8);
    color: white;
}

.feature-icon.international {
    background: linear-gradient(135deg, #ff6b35, #ff8e53);
    color: white;
}

.feature-stats {
    background: #f8f9fa;
    border-radius: 15px;
    padding: 20px;
}

.stat-number {
    font-size: 1.8rem;
    font-weight: bold;
    color: #2c3e50;
}

.stat-label {
    font-size: 0.9rem;
    color: #6c757d;
    margin-top: 5px;
}

.info-card {
    background: #f8f9fa;
    border-radius: 15px;
    border: none;
}

.info-icon {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px;
    color: white;
    font-size: 1.5rem;
}

.source-badge {
    display: inline-block;
    padding: 8px 16px;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.9rem;
    color: white;
}

.pv-badge {
    background: linear-gradient(135deg, #17a2b8, #20c997);
}

.irena-badge {
    background: linear-gradient(135deg, #ff6b35, #ff8e53);
}

.iea-badge {
    background: linear-gradient(135deg, #6f42c1, #e83e8c);
}

.btn-primary {
    background: linear-gradient(135deg, #667eea, #764ba2);
    border: none;
    border-radius: 10px;
    padding: 12px 30px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.card-title {
    color: #2c3e50;
    font-weight: 700;
}

.card-text {
    color: #6c757d;
    line-height: 1.6;
}
</style>
{% endblock %}